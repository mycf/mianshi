死锁（deadlock）是这样一种情形：第一个线程在等待第二个线程持有的某个对象锁，而第二个线程又在等待第一个线程持有的对象锁（或是由两个以上线程形成的类似情形）。由于每个线程都在等其他线程释放锁，以致每个线程都会一直这么等下去。于是，这些线程就陷入了所谓的死锁。
## 产生死锁的四个必要条件：

（1）`互斥条件`：一个资源每次只能被一个进程使用。

（2） `请求与保持条件`：一个进程因请求资源而阻塞时，对已获得的资源保持不放。

（3） `不可剥夺条件`:进程已获得的资源，在末使用完之前，不能强行剥夺。

（4） `循环等待条件`:若干进程之间形成一种头尾相接的循环等待资源关系。

# 避免死锁的几个常见方法

- 避免一个线程同时获取多个锁。

- 避免一个线程在锁内同时占用多个资源，尽量保证每个锁只占用一个资源。

- 尝试使用定时锁，使用lock.tryLock（timeout）来替代使用内部锁机制。

- 对于数据库锁，加锁和解锁必须在一个数据库连接里，否则会出现解锁失败的情况。